obj-m += galois.o

EXTRA_CFLAGS = -I@SRCDIR@/include

all:
	$(RM) ./galois.[ch]
	ln -s ../galois.c ./galois.c
	make -C /lib/modules/$(shell uname -r)/build M=$(PWD) modules
    
install modules_install:
	$(MAKE) INSTALL_MOD_DIR=kernel/fs/galois -C /lib/modules/$(shell uname -r)/build M=`pwd` modules_install

CURRENT = $(shell uname -r)
DEST = /lib/modules/$(CURRENT)/kernel/fs/galois/galois.ko

uninstall:
	su -c "rm -fr $(DEST) && /sbin/depmod -a"

clean distclean:
	$(MAKE) -C /lib/modules/$(shell uname -r)/build M=`pwd` clean
	$(RM) Module.markers modules.order
	$(RM) ./galois.[ch]
